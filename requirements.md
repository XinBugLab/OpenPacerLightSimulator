# 领跑灯模拟软件需求文档

## 1. 项目概述

本项目旨在开发一个领跑灯模拟软件，用于控制和模拟一组可编程的LED灯。这些灯可以组成序列，并根据接收到的指令进行集体或选择性控制，模拟领跑灯（Pacer Light）的效果。

## 2. 功能需求

### 2.1 指令系统

软件需要能够处理和解析特定格式的指令，指令通过无线广播方式发送给所有灯。

#### 2.1.1 指令结构

每条指令包含以下五个部分：

*   **`Id-Mask` (ID掩码)**:
    *   一个16位的掩码（例如，`FFFF`）。
    *   用于选择性地控制一个或多个灯。
    *   当一个灯的自身ID与`Id-Mask`进行按位与（AND）操作后，结果等于其自身ID时（`(Id-Mask & self.id) == self.id`），该灯响应此指令。
    *   `FFFF` 表示广播地址，匹配所有ID。

*   **`Brightness` (亮度)**:
    *   范围：0 到 255。
    *   0 表示灯完全熄灭。
    *   255 表示灯达到最大亮度。

*   **`FadeIn` (淡入时间)**:
    *   单位：微秒 (μs)。
    *   表示灯从当前亮度变化到目标`Brightness`所需的时间。

*   **`Hold` (保持时间)**:
    *   单位：毫秒 (ms)。
    *   表示灯在达到目标亮度后，保持该亮度的持续时间。

*   **`FadeOut` (淡出时间)**:
    *   单位：毫秒 (ms)。
    *   表示灯从目标亮度变化到熄灭（亮度为0）所需的时间。

### 2.2 灯的行为模拟

*   每个灯都拥有一个唯一的ID。
*   每个灯都能独立地根据接收到的指令执行亮度变化（淡入、保持、淡出）。
*   软件需要能够同时模拟多个灯的行为。
*   需要有一个可视化的界面来展示灯的状态（亮度、颜色等）。

### 2.3 控制与管理

*   能够配置和管理灯的数量和ID。
*   能够发送指令来控制灯的序列。
*   能够监控每个灯的当前状态。

## 3. 非功能需求

### 3.1 性能
*   模拟器需要能够实时响应指令，并流畅地更新大量灯的状态。
*   指令处理延迟应尽可能低。

### 3.2 可扩展性
*   系统应设计为易于扩展，以便将来可以支持更多数量的灯或更复杂的指令。

### 3.3 可用性
*   提供一个直观的用户界面，方便用户配置灯光、发送指令和观察模拟效果。